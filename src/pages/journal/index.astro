---
/**
 * journal/index.astro
 * Archive page listing all journal entries
 */

import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

// Get all non-draft entries, sorted by date
const entries = (await getCollection('journal', ({ data }) => {
  return import.meta.env.PROD ? !data.draft : true;
})).sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime());
---

<BaseLayout title="Journal â€” Mae" description="Writing process, reflections, and notes.">
  <main class="journal-archive">
    <header class="journal-archive__header">
      <h1 class="journal-archive__title">Journal</h1>
      <p class="journal-archive__intro">
        Notes on the writing process, reflections on stories in progress, and other thoughts that don't fit elsewhere.
      </p>
    </header>

    <div class="journal-archive__content">
      <ul class="journal-archive__list">
        {entries.map((entry) => (
          <li class="journal-archive__item">
            <a href={`/journal/${entry.slug}`} class="journal-archive__link">
              <time datetime={entry.data.publishDate.toISOString()} class="journal-archive__date">
                {entry.data.publishDate.toLocaleDateString('en-US', {
                  month: 'long',
                  day: 'numeric',
                  year: 'numeric'
                })}
              </time>
              <h2 class="journal-archive__entry-title">{entry.data.title}</h2>
              <p class="journal-archive__excerpt">{entry.data.excerpt}</p>
              {entry.data.tags.length > 0 && (
                <div class="journal-archive__tags">
                  {entry.data.tags.map((tag) => (
                    <span class="journal-archive__tag">{tag}</span>
                  ))}
                </div>
              )}
            </a>
          </li>
        ))}
      </ul>
    </div>
  </main>
</BaseLayout>

<style>
  .journal-archive {
    max-width: 48rem;
    margin: 0 auto;
    padding: calc(80px + var(--space-xl)) var(--space-lg) var(--space-xl);
  }

  .journal-archive__header {
    margin-bottom: var(--space-2xl);
  }

  .journal-archive__title {
    font-family: var(--font-display);
    font-size: clamp(2.5rem, 6vw, 4rem);
    font-weight: 400;
    margin-bottom: var(--space-md);
  }

  .journal-archive__intro {
    font-size: 1.0625rem;
    line-height: 1.7;
    color: var(--color-ink-soft);
    max-width: 600px;
  }

  .journal-archive__list {
    list-style: none;
  }

  .journal-archive__item {
    border-bottom: 1px solid var(--color-border);
  }

  .journal-archive__item:first-child {
    border-top: 1px solid var(--color-border);
  }

  .journal-archive__link {
    display: block;
    padding: var(--space-lg) 0;
    transition: opacity var(--duration-fast) var(--ease-out-quart);
  }

  .journal-archive__link:hover {
    opacity: 0.7;
  }

  .journal-archive__date {
    display: block;
    font-size: 0.75rem;
    font-weight: 500;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--color-stone);
    margin-bottom: var(--space-xs);
  }

  .journal-archive__entry-title {
    font-family: var(--font-display);
    font-size: 1.5rem;
    font-weight: 500;
    line-height: 1.3;
    color: var(--color-ink);
    margin-bottom: var(--space-sm);
  }

  .journal-archive__excerpt {
    font-size: 0.9375rem;
    line-height: 1.6;
    color: var(--color-ink-soft);
  }

  .journal-archive__tags {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-xs);
    margin-top: var(--space-sm);
  }

  .journal-archive__tag {
    font-size: 0.6875rem;
    font-weight: 500;
    padding: 0.25em 0.75em;
    background-color: var(--color-paper-warm);
    border-radius: 2em;
    color: var(--color-stone);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
</style>
